;  Copyright, Wazuh Inc.
;
;  Tests for products: 
;    AWS Security Hub

[AWS Security Hub - The S3 bucket used to store CloudTrail logs is publicly accessible.]
log 1 pass = {"integration": "aws", "aws": {"log_info": {"log_file": "2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl", "s3bucket":"abcd-aws-efgh"}, "source": "securityhub", "detail_type": "Security Hub Findings - Imported", "finding": {"ProductArn": "arn:aws:securityhub:abcde::product/aws/securityhub", "Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Description": "Allowing public access to CloudTrail log content might aid an adversary in identifying weaknesses in the affected account's use or configuration. To run this check, Security Hub first uses custom logic to look for the S3 bucket where your CloudTrail logs are stored.", "Compliance": {"Status": "FAILED", "SecurityControlId": "CloudTrail.6", "RelatedRequirements": ["CIS AWS Foundations Benchmark v1.2.0/2.7"], "AssociatedStandards": [{"StandardsId": "ruleset/cis-aws-foundations-benchmark/v/1.2.0"}, {"StandardsId": "standards/aws-foundational-security-best-practices/v/1.0.0"}]}, "ProductName": "Security Hub", "FirstObservedAt": "2024-01-22T09:54:13.094Z", "CreatedAt": "2024-01-22T09:54:13.094Z", "LastObservedAt": "2024-05-01T22:12:01.146Z", "CompanyName": "AWS", "FindingProviderFields": {"Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}}, "ProductFields": {"RelatedAWSResources:0/name": "securityhub-cloud-trail-encryption-enabled-abcde123", "RelatedAWSResources:0/type": "AWS::Config::ConfigRule", "aws/securityhub/ProductName": "Security Hub", "aws/securityhub/CompanyName": "AWS", "Resources:0/Id": "arn:aws:cloudtrail:abcde:123456789000:trail/david-test-jan-22-2024", "aws/securityhub/FindingId": "arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/CloudTrail.6/finding/abcde123-efgh-ijk-567"}, "Remediation": {"Recommendation": {"Text": "For information on how to correct this issue, consult the AWS Security Hub controls documentation.", "Url": "https://docs.aws.amazon.com/console/securityhub/CloudTrail.6/remediation"}}, "SchemaVersion": "2018-10-08", "GeneratorId": "security-control/CloudTrail.6", "RecordState": "ACTIVE", "Title": "CloudTrail should have encryption at-rest enabled", "Workflow": {"Status": "NEW"}, "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}, "UpdatedAt": "2024-05-01T22:11:50.865Z", "WorkflowState": "NEW", "AwsAccountId": "123456789000", "Region": "abcde", "Id": "arn:aws:securityhub:abcde:123456789000:security-control/CloudTrail.6/finding/abcde123-efgh-ijk-567", "Resources": [{"Partition": "aws", "Type": "AwsCloudTrailTrail", "Region": "abcde", "Id": "arn:aws:cloudtrail:abcde:123456789000:trail/david-test-jan-22-2024"}], "ProcessedAt": "2024-05-01T22:12:05.695Z"}}}
rule = 99836
alert = 12
decoder = json

[AWS Security Hub - CodeBuild Bitbucket source repository URL contains sensitive credentials.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Protect/Secure development"],"Description":"This control checks whether an AWS CodeBuild project Bitbucket source repository URL contains personal access tokens or a user name and password.","Compliance":{"Status":"FAILED","SecurityControlId":"CodeBuild.1","RelatedRequirements":["PCI DSS v3.2.1/8.2.1, NIST.800-53.r5 SA-3"],"AssociatedStandards":[{"StandardsId":"ruleset/cis-aws-foundations-benchmark/v/1.2.0"},{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-22T09:54:13.094Z","CreatedAt":"2024-01-22T09:54:13.094Z","LastObservedAt":"2024-05-01T22:12:01.146Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Protect/Secure development"],"Severity":{"Normalized":0,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"codebuild-project-source-repo-url-check-abcde123","RelatedAWSResources:0/type":"AWS::CodeBuild::Project","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:codebuild:abcde:123456789000:trail/david-test-jan-22-2024","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/CodeBuild.1/finding/abcde123-efgh-ijk-567"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/CodeBuild.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/CodeBuild.1","RecordState":"ACTIVE","Title":"CodeBuild Bitbucket source repository URLs should not contain sensitive credentials","Workflow":{"Status":"NEW"},"Severity":{"Normalized":0,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-01T22:11:50.865Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/CodeBuild.1/finding/abcde123-efgh-ijk-567","Resources":[{"Partition":"aws","Type":"AwsCodeBuild","Region":"abcde","Id":"arn:aws:codebuild:abcde:123456789000:build/david-test-jan-22-2024"}],"ProcessedAt":"2024-05-01T22:12:05.695Z"}}}
rule = 99837
alert = 12
decoder = json

[AWS Security Hub - CodeBuild project environment variable contain clear text credentials.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-07-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Protect/Secure development"],"Description":"This control checks whether the project contains the environment variables AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.","Compliance":{"Status":"FAILED","SecurityControlId":"CodeBuild.2","RelatedRequirements":["PCI DSS v3.2.1/8.2.1, NIST.800-53.r5 IA-5(7), NIST.800-53.r5 SA-3"],"AssociatedStandards":[{"StandardsId":"ruleset/cis-aws-foundations-benchmark/v/1.2.0"},{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-22T09:54:13.094Z","CreatedAt":"2024-01-22T09:54:13.094Z","LastObservedAt":"2024-05-01T22:12:01.146Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Protect/Secure development"],"Severity":{"Normalized":0,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"codebuild-project-envvar-awscred-check-abcde123","RelatedAWSResources:0/type":"AWS::CodeBuild::Project","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:codebuild:abcde:123456789000:trail/david-test-jan-22-2024","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/CodeBuild.2/finding/abcde123-efgh-ijk-567"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/CodeBuild.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/CodeBuild.2","RecordState":"ACTIVE","Title":"CodeBuild project environment variables should not contain clear text credentials","Workflow":{"Status":"NEW"},"Severity":{"Normalized":0,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:11:50.865Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/CodeBuild.2/finding/abcde123-efgh-ijk-567","Resources":[{"Partition":"aws","Type":"AwsCloudTrailTrail","Region":"abcde","Id":"arn:aws:codebuild:abcde:123456789000:build/david-test-jan-22-2024"}],"ProcessedAt":"2024-05-02T22:12:05.695Z"}}}
rule = 99838
alert = 12
decoder = json

[AWS Security Hub - Database Migration Service replication instance is public.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Protect/Secure network configuration"],"Description":"This control checks whether AWS DMS replication instances are public.","Compliance":{"Status":"FAILED","SecurityControlId":"DMS.1","RelatedRequirements":["PCI DSS v3.2.1/1.2.1,PCI DSS v3.2.1/1.3.1,PCI DSS v3.2.1/1.3.4,PCI DSS v3.2.1/1.3.2,PCI DSS v3.2.1/1.3.6, NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)"],"AssociatedStandards":[{"StandardsId":"ruleset/cis-aws-foundations-benchmark/v/1.2.0"},{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:17.001Z","CreatedAt":"2024-01-05T09:26:17.001Z","LastObservedAt":"2024-05-01T22:12:20.039Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Protect/Secure network configuration"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"dms-replication-not-public-664bd5dd","RelatedAWSResources:0/type":"AWS::DMS::ReplicationInstance","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/DMS.1/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/DMS.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/DMS.1","RecordState":"ACTIVE","Title":"Database Migration Service replication instances should not be public","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-01T22:12:09.158Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/DMS.1/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsDMS","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-01T22:12:24.049Z"}}}
rule = 99839
alert = 12
decoder = json

[AWS Security Hub - Amazon DocumentDB manual cluster snapshot is public.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Protect/Secure network configuration"],"Description":"This control checks whether an Amazon DocumentDB manual cluster snapshot is public.","Compliance":{"Status":"FAILED","SecurityControlId":"DocumentDB.3","RelatedRequirements":["NIST.800-53.r5 AC-21, NIST.800-53.r5 AC-3, NIST.800-53.r5 AC-3(7), NIST.800-53.r5 AC-4, NIST.800-53.r5 AC-4(21), NIST.800-53.r5 AC-6, NIST.800-53.r5 SC-7, NIST.800-53.r5 SC-7(11), NIST.800-53.r5 SC-7(16), NIST.800-53.r5 SC-7(20), NIST.800-53.r5 SC-7(21), NIST.800-53.r5 SC-7(3), NIST.800-53.r5 SC-7(4), NIST.800-53.r5 SC-7(9)"],"AssociatedStandards":[{"StandardsId":"ruleset/cis-aws-foundations-benchmark/v/1.2.0"},{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:17.001Z","CreatedAt":"2024-01-05T09:26:17.001Z","LastObservedAt":"2024-05-01T22:12:20.039Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Protect/Secure network configuration"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"docdb-cluster-snapshot-public-prohibited-664bd5dd","RelatedAWSResources:0/type":"AWS::RDS:DBSnapshot","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/DocumentDB.3/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/DocumentDB.3/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/DocumentDB.3","RecordState":"ACTIVE","Title":"Amazon DocumentDB manual cluster snapshots should not be public","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-01T22:12:09.158Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/DocumentDB.3/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsDMS","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-01T22:12:24.049Z"}}}
rule = 99840
alert = 12
decoder = json

[AWS Security Hub - EBS snapshot is publicly restorable.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This AWS control checks whether Amazon Elastic Block Store snapshots are not publicly restorable.","Compliance":{"Status":"FAILED","SecurityControlId":"EC2.1","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:37.617Z","CreatedAt":"2024-01-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"securityhub-ebs-snapshot-public-restorable-check-661f086b","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/EC2.1/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/EC2.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/EC2.1","RecordState":"ACTIVE","Title":"EBS snapshots should not be publicly restorable","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/EC2.1/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99841
alert = 12
decoder = json

[AWS Security Hub - Security groups allow unrestricted access to ports with high risk.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether unrestricted incoming traffic for an Amazon EC2 security group is accessible to the specified ports that are considered to be high risk.","Compliance":{"Status":"FAILED","SecurityControlId":"EC2.19","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:37.617Z","CreatedAt":"2024-01-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"restricted-common-ports-661f086b","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/EC2.19/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/EC2.19/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/EC2.19","RecordState":"ACTIVE","Title":"Security groups should not allow unrestricted access to ports with high risk","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/EC2.19/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99842
alert = 12
decoder = json

[AWS Security Hub - Amazon EMR block public access setting not enabled.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether your account is configured with Amazon EMR block public access.","Compliance":{"Status":"FAILED","SecurityControlId":"EMR.2","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:37.617Z","CreatedAt":"2024-01-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"emr-block-public-access-661f086b","RelatedAWSResources:0/type":"AWS::::Account","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/EMR.2/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/EMR.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/EMR.2","RecordState":"ACTIVE","Title":"Amazon EMR block public access setting should be enabled","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/EMR.2/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99843
alert = 12
decoder = json

[AWS Security Hub - Elasticsearch domain is publicly accessible.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether Elasticsearch domains are in a VPC.","Compliance":{"Status":"FAILED","SecurityControlId":"ES.2","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-02-05T09:26:37.617Z","CreatedAt":"2024-02-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"elasticsearch-in-vpc-only-661f086b","RelatedAWSResources:0/type":"AWS::Elasticsearch::Domain","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/ES.2/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/ES.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/ES.2","RecordState":"ACTIVE","Title":"Elasticsearch domains should not be publicly accessible","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/ES.2/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99844
alert = 12
decoder = json

[AWS Security Hub - IAM root user access key exists.]
log 1 pass = {"integration": "aws", "aws": {"log_info": {"log_file": "2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl", "s3bucket":"abcd-aws-efgh"}, "source": "securityhub", "detail_type": "Security Hub Findings - Imported", "finding": {"ProductArn": "arn:aws:securityhub:abcde::product/aws/securityhub", "Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Description": "This control checks whether the root user access key is present.", "Compliance": {"Status": "FAILED", "SecurityControlId": "IAM.4", "RelatedRequirements": ["CIS AWS Foundations Benchmark v1.2.0/1.14"], "AssociatedStandards": [{"StandardsId": "ruleset/cis-aws-foundations-benchmark/v/1.2.0"}, {"StandardsId": "standards/aws-foundational-security-best-practices/v/1.0.0"}]}, "ProductName": "Security Hub", "FirstObservedAt": "2024-01-05T09:26:17.001Z", "CreatedAt": "2024-01-05T09:26:17.001Z", "LastObservedAt": "2024-05-01T22:12:20.039Z", "CompanyName": "AWS", "FindingProviderFields": {"Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}}, "ProductFields": {"RelatedAWSResources:0/name": "securityhub-abcd-account-hardware-mfa-enabled-664bd5dd", "RelatedAWSResources:0/type": "AWS::Config::ConfigRule", "aws/securityhub/ProductName": "Security Hub", "aws/securityhub/CompanyName": "AWS", "Resources:0/Id": "arn:aws:iam::123456789000:abcd", "aws/securityhub/FindingId": "arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/IAM.4/finding/abcd-bcde-1234-5678"}, "Remediation": {"Recommendation": {"Text": "For information on how to correct this issue, consult the AWS Security Hub controls documentation.", "Url": "https://docs.aws.amazon.com/console/securityhub/IAM.4/remediation"}}, "SchemaVersion": "2018-10-08", "GeneratorId": "security-control/IAM.4", "RecordState": "ACTIVE", "Title": "Hardware MFA should be enabled for the root user", "Workflow": {"Status": "NEW"}, "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}, "UpdatedAt": "2024-05-01T22:12:09.158Z", "WorkflowState": "NEW", "AwsAccountId": "123456789000", "Region": "abcde", "Id": "arn:aws:securityhub:abcde:123456789000:security-control/IAM.4/finding/abcd-bcde-1234-5678", "Resources": [{"Partition": "aws", "Type": "AwsAccount", "Region": "abcde", "Id": "AWS::::Account:123456789000"}], "ProcessedAt": "2024-05-01T22:12:24.049Z"}}}
rule = 99845
alert = 12
decoder = json

[AWS Security Hub - Hardware MFA not enabled for the root user.]
log 1 pass = {"integration": "aws", "aws": {"log_info": {"log_file": "2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl", "s3bucket":"abcd-aws-efgh"}, "source": "securityhub", "detail_type": "Security Hub Findings - Imported", "finding": {"ProductArn": "arn:aws:securityhub:abcde::product/aws/securityhub", "Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Description": "This AWS control checks whether your AWS account is enabled to use a hardware multi-factor authentication (MFA) device to sign in with root user credentials.", "Compliance": {"Status": "FAILED", "SecurityControlId": "IAM.6", "RelatedRequirements": ["CIS AWS Foundations Benchmark v1.2.0/1.14"], "AssociatedStandards": [{"StandardsId": "ruleset/cis-aws-foundations-benchmark/v/1.2.0"}, {"StandardsId": "standards/aws-foundational-security-best-practices/v/1.0.0"}]}, "ProductName": "Security Hub", "FirstObservedAt": "2024-01-05T09:26:17.001Z", "CreatedAt": "2024-01-05T09:26:17.001Z", "LastObservedAt": "2024-05-01T22:12:20.039Z", "CompanyName": "AWS", "FindingProviderFields": {"Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}}, "ProductFields": {"RelatedAWSResources:0/name": "securityhub-abcd-account-hardware-mfa-enabled-664bd5dd", "RelatedAWSResources:0/type": "AWS::Config::ConfigRule", "aws/securityhub/ProductName": "Security Hub", "aws/securityhub/CompanyName": "AWS", "Resources:0/Id": "arn:aws:iam::123456789000:abcd", "aws/securityhub/FindingId": "arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/IAM.6/finding/abcd-bcde-1234-5678"}, "Remediation": {"Recommendation": {"Text": "For information on how to correct this issue, consult the AWS Security Hub controls documentation.", "Url": "https://docs.aws.amazon.com/console/securityhub/IAM.6/remediation"}}, "SchemaVersion": "2018-10-08", "GeneratorId": "security-control/IAM.6", "RecordState": "ACTIVE", "Title": "Hardware MFA should be enabled for the root user", "Workflow": {"Status": "NEW"}, "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}, "UpdatedAt": "2024-05-01T22:12:09.158Z", "WorkflowState": "NEW", "AwsAccountId": "123456789000", "Region": "abcde", "Id": "arn:aws:securityhub:abcde:123456789000:security-control/IAM.6/finding/abcd-bcde-1234-5678", "Resources": [{"Partition": "aws", "Type": "AwsAccount", "Region": "abcde", "Id": "AWS::::Account:123456789000"}], "ProcessedAt": "2024-05-01T22:12:24.049Z"}}}
rule = 99846
alert = 12
decoder = json

[AWS Security Hub - MFA not enabled for the root user.]
log 1 pass = {"integration": "aws", "aws": {"log_info": {"log_file": "2024/05/01/22/wazuh-security-hub-findings-1-2024-05-01-22-12-07-abcde-fgh-ijkl", "s3bucket":"abcd-aws-efgh"}, "source": "securityhub", "detail_type": "Security Hub Findings - Imported", "finding": {"ProductArn": "arn:aws:securityhub:abcde::product/aws/securityhub", "Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Description": "This AWS control checks whether users of your AWS account require a multi-factor authentication (MFA) device to sign in with root user credentials.", "Compliance": {"Status": "FAILED", "SecurityControlId": "IAM.9", "RelatedRequirements": ["CIS AWS Foundations Benchmark v1.2.0/1.13"], "AssociatedStandards": [{"StandardsId": "ruleset/cis-aws-foundations-benchmark/v/1.2.0"}]}, "ProductName": "Security Hub", "FirstObservedAt": "2024-01-05T09:26:08.142Z", "CreatedAt": "2024-01-05T09:26:08.142Z", "LastObservedAt": "2024-05-01T22:12:22.691Z", "CompanyName": "AWS", "FindingProviderFields": {"Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}}, "ProductFields": {"RelatedAWSResources:0/name": "securityhub-abcd-account-mfa-enabled-d58a4c25", "RelatedAWSResources:0/type": "AWS::Config::ConfigRule", "aws/securityhub/ProductName": "Security Hub", "aws/securityhub/CompanyName": "AWS", "Resources:0/Id": "arn:aws:iam::123456789000:abcd", "aws/securityhub/FindingId": "arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/IAM.9/finding/abcd-efg-ijkln"}, "Remediation": {"Recommendation": {"Text": "For information on how to correct this issue, consult the AWS Security Hub controls documentation.", "Url": "https://docs.aws.amazon.com/console/securityhub/IAM.9/remediation"}}, "SchemaVersion": "2018-10-08", "GeneratorId": "security-control/IAM.9", "RecordState": "ACTIVE", "Title": "MFA should be enabled for the root user", "Workflow": {"Status": "NEW"}, "Severity": {"Normalized": 90, "Label": "CRITICAL", "Original": "CRITICAL"}, "UpdatedAt": "2024-05-01T22:12:10.223Z", "WorkflowState": "NEW", "AwsAccountId": "123456789000", "Region": "abcde", "Id": "arn:aws:securityhub:abcde:123456789000:security-control/IAM.9/finding/abcd-efg-ijkln", "Resources": [{"Partition": "aws", "Type": "AwsAccount", "Region": "abcde", "Id": "AWS::::Account:123456789000"}], "ProcessedAt": "2024-05-01T22:12:27.576Z"}}}
rule = 99847
alert = 12
decoder = json

[AWS Security Hub - AWS KMS keys scheduled for deletion.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/06/wazuh-security-hub-findings-1-2024-05-05-06-58-00-12345678-ABCDEFGH-IJKLMN","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether KMS keys are scheduled for deletion. The control fails if a KMS key is scheduled for deletion.","Compliance":{"Status":"FAILED","SecurityControlId":"KMS.3","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:54.731Z","CreatedAt":"2024-01-05T09:25:54.731Z","LastObservedAt":"2024-05-05T06:58:33.628Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"kms-cmk-not-scheduled-for-deletion-2-c42fad05","RelatedAWSResources:0/type":"AWS::KMS::Key","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/KMS.3/finding/12345678-ABCDEFGH-IJKLMN"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/KMS.3/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/KMS.3","RecordState":"ACTIVE","Title":"AWS KMS keys should not be deleted unintentionally","Workflow":{"Status":"NEW"},"Severity":{"Normalized":0,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-05T06:58:16.818Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/KMS.3/finding/12345678-ABCDEFGH-IJKLMN","Resources":[{"Partition":"aws","Type":"AwsIamRole","Details":{"AwsIamRole":{"Path":"/service-role/","AttachedManagedPolicies":[{"PolicyArn":"arn:aws:iam::123456789000:policy/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","PolicyName":"Amazon_EventBridge_Invoke_Firehose_12345678"}],"RoleName":"Amazon_EventBridge_Invoke_Firehose_12345678","AssumeRolePolicyDocument":"abcdefgh","CreateDate":"2021-12-02T17:41:55.000Z","RoleId":"ABCEDFHIJKLMONPQ"}},"Region":"abcde","Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678"}],"ProcessedAt":"2024-05-05T06:58:37.814Z"}}}
rule = 99848
alert = 12
decoder = json

[AWS Security Hub - Lambda function policies allow public access.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether the Lambda function resource-based policy prohibits public access outside of your account.","Compliance":{"Status":"FAILED","SecurityControlId":"Lambda.1","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-02-05T09:26:37.617Z","CreatedAt":"2024-02-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"lambda-function-public-access-prohibited-661f086b","RelatedAWSResources:0/type":"AWS::Lambda::Function","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/Lambda.1/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/Lambda.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/Lambda.1","RecordState":"ACTIVE","Title":"Lambda function policies should prohibit public access","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/Lambda.1/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99849
alert = 12
decoder = json

[AWS Security Hub - Neptune DB cluster snapshot is public.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether a Neptune manual DB cluster snapshot is public. The control fails if a Neptune manual DB cluster snapshot is public.","Compliance":{"Status":"FAILED","SecurityControlId":"Neptune.3","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-02-05T09:26:37.617Z","CreatedAt":"2024-02-05T09:26:37.617Z","LastObservedAt":"2024-05-02T22:12:25.627Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"neptune-cluster-snapshot-public-prohibited-661f086b","RelatedAWSResources:0/type":"AWS::RDS::DBClusterSnapshot","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/Neptune.3/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/Neptune.3/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/Neptune.3","RecordState":"ACTIVE","Title":"Neptune DB cluster snapshots should not be public","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:08.383Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/Neptune.3/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsAccount","Region":"abcde","Id":"AWS::::Account:123456789000"}],"ProcessedAt":"2024-05-02T22:12:31.673Z"}}}
rule = 99850
alert = 12
decoder = json

[AWS Security Hub - OpenSearch domain is publicly accessible.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/12/wazuh-security-hub-findings-1-2024-05-05-12-11-41-752f0518-ee38-4652-911f-f6f824a9689d","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether OpenSearch domains are in a VPC.","Compliance":{"Status":"FAILED","SecurityControlId":"Opensearch.2","RelatedRequirements":["CIS AWS Foundations Benchmark v1.2.0/1.16"],"AssociatedStandards":[{"StandardsId":"ruleset/cis-aws-foundations-benchmark/v/1.2.0"},{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:56.949Z","CreatedAt":"2024-01-05T09:25:56.949Z","LastObservedAt":"2024-05-05T12:14:36.075Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"opensearch-in-vpc-only-ea7fc269","RelatedAWSResources:0/type":"AWS::OpenSearch::Domain","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:user/abcd","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/Opensearch.2/finding/abcd-efg-ijkln"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/Opensearch.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/Opensearch.2","RecordState":"ACTIVE","Title":"OpenSearch domains should not be publicly accessible","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-05T12:14:24.927Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/Opensearch.2/finding/abcd-efg-ijkln","Resources":[{"Partition":"aws","Type":"AwsIamUser","Region":"abcde","Id":"arn:aws:iam::123456789000:user/abcd"}],"ProcessedAt":"2024-05-05T12:14:40.931Z"}}}
rule = 99851
alert = 12
decoder = json

[AWS Security Hub - RDS snapshot is public.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/06/wazuh-security-hub-findings-1-2024-05-05-06-58-00-12345678-ABCDEFGH-IJKLMN","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether Amazon RDS snapshots are public. The control fails if RDS snapshots are public.","Compliance":{"Status":"FAILED","SecurityControlId":"RDS.1","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:54.731Z","CreatedAt":"2024-01-05T09:25:54.731Z","LastObservedAt":"2024-05-05T06:58:33.628Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"rds-snapshots-public-prohibited-c42fad05","RelatedAWSResources:0/type":"AWS::RDS::DBSnapshot","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/RDS.1/finding/12345678-ABCDEFGH-IJKLMN"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/RDS.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/RDS.1","RecordState":"ACTIVE","Title":"RDS snapshot should be private","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-05T06:58:16.818Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/RDS.1/finding/12345678-ABCDEFGH-IJKLMN","Resources":[{"Partition":"aws","Type":"AwsIamRole","Details":{"AwsIamRole":{"Path":"/service-role/","AttachedManagedPolicies":[{"PolicyArn":"arn:aws:iam::123456789000:policy/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","PolicyName":"Amazon_EventBridge_Invoke_Firehose_12345678"}],"RoleName":"Amazon_EventBridge_Invoke_Firehose_12345678","AssumeRolePolicyDocument":"%7B%22Version%22%3A%222012-10-17%22%2C%22Statement%22%3A%5B%7B%22Effect%22%3A%22Allow%22%2C%22Principal%22%3A%7B%22Service%22%3A%22events.amazonaws.com%22%7D%2C%22Action%22%3A%22sts%3AAssumeRole%22%7D%5D%7D","CreateDate":"2021-12-02T17:41:55.000Z","RoleId":"ABCEDFHIJKLMONPQ"}},"Region":"abcde","Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678"}],"ProcessedAt":"2024-05-05T06:58:37.814Z"}}}
rule = 99852
alert = 12
decoder = json

[AWS Security Hub - Amazon RDS instance is publicly accessible.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/06/wazuh-security-hub-findings-1-2024-05-05-06-58-00-12345678-ABCDEFGH-IJKLMN","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether Amazon RDS instances are publicly accessible by evaluating the PubliclyAccessible field in the instance configuration item.","Compliance":{"Status":"FAILED","SecurityControlId":"RDS.2","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:54.731Z","CreatedAt":"2024-01-05T09:25:54.731Z","LastObservedAt":"2024-05-05T06:58:33.628Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"rds-instance-public-access-check-c42fad05","RelatedAWSResources:0/type":"AWS::RDS::DBInstance","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/RDS.2/finding/12345678-ABCDEFGH-IJKLMN"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/RDS.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/RDS.2","RecordState":"ACTIVE","Title":"RDS DB Instances should prohibit public access, as determined by the PubliclyAccessible AWS Configuration","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-05T06:58:16.818Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/RDS.2/finding/12345678-ABCDEFGH-IJKLMN","Resources":[{"Partition":"aws","Type":"AwsIamRole","Details":{"AwsIamRole":{"Path":"/service-role/","AttachedManagedPolicies":[{"PolicyArn":"arn:aws:iam::123456789000:policy/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","PolicyName":"Amazon_EventBridge_Invoke_Firehose_12345678"}],"RoleName":"Amazon_EventBridge_Invoke_Firehose_12345678","AssumeRolePolicyDocument":"%7B%22","CreateDate":"2021-12-02T17:41:55.000Z","RoleId":"ABCEDFHIJKLMONPQ"}},"Region":"abcde","Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678"}],"ProcessedAt":"2024-05-05T06:58:37.814Z"}}}
rule = 99853
alert = 12
decoder = json

[AWS Security Hub -  Amazon Redshift cluster is publicly accessible.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/06/wazuh-security-hub-findings-1-2024-05-05-06-58-00-12345678-ABCDEFGH-IJKLMN","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether Amazon Redshift clusters are publicly accessible. It evaluates the PubliclyAccessible field in the cluster configuration item.","Compliance":{"Status":"FAILED","SecurityControlId":"Redshift.1","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:54.731Z","CreatedAt":"2024-01-05T09:25:54.731Z","LastObservedAt":"2024-05-05T06:58:33.628Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"redshift-cluster-public-access-check-c42fad05","RelatedAWSResources:0/type":"AWS::Redshift::Cluster","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/Redshift.1/finding/12345678-ABCDEFGH-IJKLMN"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/Redshift.1/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/Redshift.1","RecordState":"ACTIVE","Title":"Amazon Redshift clusters should prohibit public access","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-05T06:58:16.818Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/Redshift.1/finding/12345678-ABCDEFGH-IJKLMN","Resources":[{"Partition":"aws","Type":"AwsIamRole","Details":{"AwsIamRole":{"Path":"/service-role/","AttachedManagedPolicies":[{"PolicyArn":"arn:aws:iam::123456789000:policy/service-role/Amazon_EventBridge_Invoke_Firehose_12345678","PolicyName":"Amazon_EventBridge_Invoke_Firehose_12345678"}],"RoleName":"Amazon_EventBridge_Invoke_Firehose_12345678","AssumeRolePolicyDocument":"%7B%22Versio","CreateDate":"2021-12-02T17:41:55.000Z","RoleId":"ABCEDFHIJKLMONPQ"}},"Region":"abcde","Id":"arn:aws:iam::123456789000:role/service-role/Amazon_EventBridge_Invoke_Firehose_12345678"}],"ProcessedAt":"2024-05-05T06:58:37.814Z"}}}
rule = 99854
alert = 12
decoder = json

[AWS Security Hub - Amazon S3 general purpose bucket permits public read access.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/02/22/wazuh-security-hub-findings-1-2024-05-02-22-12-04-abcde-fgh-ijkl","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether an Amazon S3 general purpose bucket permits public read access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if the bucket permits public read access.","Compliance":{"Status":"FAILED","SecurityControlId":"S3.2","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:52.679Z","CreatedAt":"2024-01-05T09:25:52.679Z","LastObservedAt":"2024-05-02T22:12:31.252Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"securityhub-s3-bucket-public-read-prohibited-6ece4b8d","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:s3:::abcd-efghij","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-controlS3.2/finding/cabcd-efghij-1234-567890"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/S3.2/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/S3.2","RecordState":"ACTIVE","Title":"S3 general purpose buckets should block public read access","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-02T22:12:16.185Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/S3.2/finding/cabcd-efghij-1234-567890","Resources":[{"Partition":"aws","Type":"AwsS3Bucket","Details":{"AwsS3Bucket":{"OwnerId":"abcdefghijklmnop123456789","CreatedAt":"2023-09-22T15:04:52.000Z","Name":"abcedf"}},"Region":"abcde","Id":"arn:aws:s3:::abcd-efghij","Tags":{"team":"global"}}],"ProcessedAt":"2024-05-02T22:12:36.776Z"}}}
rule = 99855
alert = 12
decoder = json

[AWS Security Hub - Amazon S3 general purpose bucket permits public write access.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/03/22/wazuh-security-hub-findings-1-2024-05-03-22-06-27-7beeb5a6-5034-4578-879f-edaae26bd428","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether an Amazon S3 general purpose bucket permits public write access. It evaluates the block public access settings, the bucket policy, and the bucket access control list (ACL). The control fails if the bucket permits public write access.","Compliance":{"Status":"FAILED","SecurityControlId":"S3.3","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:39.455Z","CreatedAt":"2024-01-05T09:25:39.455Z","LastObservedAt":"2024-05-03T22:07:02.633Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"securityhub-s3-bucket-public-write-prohibited-bf62cdc0","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:s3:::abcd-efghijk-23467890","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/S3.3/finding/abcd-efghijk-23467890"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/S3.3/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/S3.3","RecordState":"ACTIVE","Title":"S3 general purpose buckets should block public write access","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-03T22:06:51.023Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/S3.3/finding/abcd-efghijk-23467890","Resources":[{"Partition":"aws","Type":"AwsS3Bucket","Details":{"AwsS3Bucket":{"OwnerId":"abcdefghijklmnop123456789","CreatedAt":"2023-10-25T15:16:14.000Z","Name":"abcd-efghijk-23467890"}},"Region":"abcde","Id":"arn:aws:s3:::abcd-efghijk-23467890"}],"ProcessedAt":"2024-05-03T22:07:06.226Z"}}}
rule = 99856
alert = 12
decoder = json

[AWS Security Hub - Amazon S3 access point block public access settings are not enabled.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/03/22/wazuh-security-hub-findings-1-2024-05-03-22-06-27-7beeb5a6-5034-4578-879f-edaae26bd428","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Effects/Data Exposure"],"Description":"This control checks whether an Amazon S3 access point has block public access settings enabled. The control fails if block public access settings are not enabled for the access point.","Compliance":{"Status":"FAILED","SecurityControlId":"S3.19","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:39.455Z","CreatedAt":"2024-01-05T09:25:39.455Z","LastObservedAt":"2024-05-03T22:07:02.633Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Effects/Data Exposure"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"s3-access-point-public-access-blocks-bf62cdc0","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:s3:::abcd-efghijk-23467890","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/S3.19/finding/abcd-efghijk-23467890"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/S3.19/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/S3.19","RecordState":"ACTIVE","Title":"S3 access points should have block public access settings enabled","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-03T22:06:51.023Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/S3.19/finding/abcd-efghijk-23467890","Resources":[{"Partition":"aws","Type":"AwsS3Bucket","Details":{"AwsS3Bucket":{"OwnerId":"abcdefghijklmnop123456789","CreatedAt":"2023-10-25T15:16:14.000Z","Name":"abcd-efghijk-23467890"}},"Region":"abcde","Id":"arn:aws:s3:::abcd-efghijk-23467890"}],"ProcessedAt":"2024-05-03T22:07:06.226Z"}}}
rule = 99857
alert = 12
decoder = json

[AWS Security Hub - AWS Systems Manager document is public.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/03/04/wazuh-security-hub-findings-1-2024-05-03-04-55-22-5c63be12-ad8e-41d5-b95b-a82f749cb709","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether AWS Systems Manager documents that the account owns are public. This control fails if SSM documents that have \"Self\" as the owner are public.","Compliance":{"Status":"FAILED","SecurityControlId":"SSM.4","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:26:17.215Z","CreatedAt":"2024-01-05T09:26:17.215Z","LastObservedAt":"2024-05-03T04:55:41.619Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"}},"ProductFields":{"RelatedAWSResources:0/name":"securityhub-ssm-document-not-public-e00d8334","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:ssm:abcde:123456789000:document/AWSQuickSetup-CreateAndAttachIAMToInstance-issh5","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/SSM.4/finding/abcd-efghijk-23467890"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/SSM.4/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/SSM.4","RecordState":"ACTIVE","Title":"SSM documents should not be public","Workflow":{"Status":"NEW"},"Severity":{"Normalized":90,"Label":"CRITICAL","Original":"CRITICAL"},"UpdatedAt":"2024-05-03T04:55:29.739Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/SSM.4/finding/abcd-efghijk-23467890","Resources":[{"Partition":"aws","Type":"AwsSsmDocument","Region":"abcde","Id":"arn:aws:ssm:abcde:123456789000:document/AWSQuickSetup-CreateAndAttachIAMToInstance-issh5","Tags":{"QuickSetupType":"Host Management","QuickSetupVersion":"3.1","QuickSetupID":"issh5"}}],"ProcessedAt":"2024-05-03T04:55:45.778Z"}}}
rule = 99858
alert = 12
decoder = json

[AWS Security Hub - Amazon EC2 Instance uses a public IPv4 address.]
log 1 pass = {"integration": "aws", "aws": {"log_info": {"log_file": "2024/05/10/05/wazuh-security-hub-findings-1-2024-05-10-05-01-41-abced-fghi-123", "s3bucket": "abced-fghj"}, "source": "securityhub", "detail_type": "Security Hub Findings - Imported", "finding": {"ProductArn": "arn:aws:securityhub:abced::product/aws/securityhub", "Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Description": "This control checks whether EC2 instances have a public IP address. The control fails if the publicIp field is present in the EC2 instance configuration item. This control applies to IPv4 addresses only.", "Compliance": {"Status": "FAILED", "SecurityControlId": "EC2.9", "AssociatedStandards": [{"StandardsId": "standards/aws-foundational-security-best-practices/v/1.0.0"}]}, "ProductName": "Security Hub", "FirstObservedAt": "2024-04-15T10:00:30.759Z", "CreatedAt": "2024-04-15T10:00:30.759Z", "LastObservedAt": "2024-05-10T05:02:02.333Z", "CompanyName": "AWS", "FindingProviderFields": {"Types": ["Software and Configuration Checks/Industry and Regulatory Standards"], "Severity": {"Normalized": 70, "Label": "HIGH", "Original": "HIGH"}}, "ProductFields": {"RelatedAWSResources:0/name": "securityhub-ec2-instance-no-public-ip-abced", "RelatedAWSResources:0/type": "AWS::Config::ConfigRule", "aws/securityhub/ProductName": "Security Hub", "aws/securityhub/CompanyName": "AWS", "aws/securityhub/annotation": "This Amazon EC2 Instance uses a public IP.", "Resources:0/Id": "arn:aws:ec2:abced:123456789000:instance/i-0123456abced", "aws/securityhub/FindingId": "arn:aws:securityhub:abced::product/aws/securityhub/arn:aws:securityhub:abced:123456789000:security-control/EC2.9/finding/abced-fghij1"}, "Remediation": {"Recommendation": {"Text": "For information on how to correct this issue, consult the AWS Security Hub controls documentation.", "Url": "https://docs.aws.amazon.com/console/securityhub/EC2.9/remediation"}}, "SchemaVersion": "2018-10-08", "GeneratorId": "security-control/EC2.9", "RecordState": "ACTIVE", "Title": "EC2 instances should not have a public IPv4 address", "Workflow": {"Status": "NEW"}, "Severity": {"Normalized": 70, "Label": "HIGH", "Original": "HIGH"}, "UpdatedAt": "2024-05-10T05:01:57.040Z", "WorkflowState": "NEW", "AwsAccountId": "123456789000", "Region": "abced", "Id": "arn:aws:securityhub:abced:123456789000:security-control/EC2.9/finding/abced-fghij1", "Resources": [{"Partition": "aws", "Type": "AwsEc2Instance", "Details": {"AwsEc2Instance": {"KeyName": "idr-1052", "VpcId": "vpc-f825c385", "MetadataOptions": {"HttpPutResponseHopLimit": 1, "HttpProtocolIpv6": "disabled", "HttpTokens": "optional", "InstanceMetadataTags": "disabled", "HttpEndpoint": "enabled"}, "VirtualizationType": "hvm", "NetworkInterfaces": [{"NetworkInterfaceId": "eni-0fb7c2e3d7a995865"}], "ImageId": "abc-123456789", "SubnetId": "subnet-abcd123", "LaunchedAt": "2024-04-15T09:57:14.000Z", "Monitoring": {"State": "disabled"}}}, "Region": "abced", "Id": "arn:aws:ec2:abced:123456789000:instance/i-1234567890"}], "ProcessedAt": "2024-05-10T05:02:05.667Z"}}}
rule = 99859
alert = 12
decoder = json

[AWS Security Hub - Amazon S3 general purpose bucket allows public access at the bucket level.]
log 1 pass = {"integration":"aws","aws":{"log_info":{"log_file":"2024/05/05/18/wazuh-security-hub-findings-1-2024-05-05-18-03-35-abcd-def-ghij-klmn","s3bucket":"abcd-aws-efgh"},"source":"securityhub","detail_type":"Security Hub Findings - Imported","finding":{"ProductArn":"arn:aws:securityhub:abcde::product/aws/securityhub","Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Description":"This control checks whether an Amazon S3 general purpose bucket blocks public access at the bucket level. The control fails if any of the following settings are set to false: ignorePublicAcls, blockPublicPolicy, blockPublicAcls, restrictPublicBuckets.","Compliance":{"Status":"FAILED","SecurityControlId":"S3.8","AssociatedStandards":[{"StandardsId":"standards/aws-foundational-security-best-practices/v/1.0.0"}]},"ProductName":"Security Hub","FirstObservedAt":"2024-01-05T09:25:54.684Z","CreatedAt":"2024-01-05T09:25:54.684Z","LastObservedAt":"2024-05-05T18:03:55.756Z","CompanyName":"AWS","FindingProviderFields":{"Types":["Software and Configuration Checks/Industry and Regulatory Standards"],"Severity":{"Normalized":70,"Label":"HIGH","Original":"HIGH"}},"ProductFields":{"RelatedAWSResources:0/name":"securityhub-s3-bucket-level-public-access-prohibited-abcdefg","RelatedAWSResources:0/type":"AWS::Config::ConfigRule","aws/securityhub/ProductName":"Security Hub","aws/securityhub/CompanyName":"AWS","Resources:0/Id":"arn:aws:s3:::abcdef","aws/securityhub/FindingId":"arn:aws:securityhub:abcde::product/aws/securityhub/arn:aws:securityhub:abcde:123456789000:security-control/S3.8/finding/abcd-bcde-1234-5678"},"Remediation":{"Recommendation":{"Text":"For information on how to correct this issue, consult the AWS Security Hub controls documentation.","Url":"https://docs.aws.amazon.com/console/securityhub/S3.8/remediation"}},"SchemaVersion":"2018-10-08","GeneratorId":"security-control/S3.8","RecordState":"ACTIVE","Title":"S3 general purpose buckets should block public access","Workflow":{"Status":"NEW"},"Severity":{"Normalized":70,"Label":"HIGH","Original":"HIGH"},"UpdatedAt":"2024-05-05T18:03:42.479Z","WorkflowState":"NEW","AwsAccountId":"123456789000","Region":"abcde","Id":"arn:aws:securityhub:abcde:123456789000:security-control/S3.8/finding/abcd-bcde-1234-5678","Resources":[{"Partition":"aws","Type":"AwsS3Bucket","Details":{"AwsS3Bucket":{"OwnerId":"abcdefghijklmnop123456789","CreatedAt":"2021-11-26T11:36:13.000Z","Name":"abcde"}},"Region":"abcde","Id":"arn:aws:s3:::abcdef"}],"ProcessedAt":"2024-05-05T18:04:02.343Z"}}}
rule = 99860
alert = 12
decoder = json