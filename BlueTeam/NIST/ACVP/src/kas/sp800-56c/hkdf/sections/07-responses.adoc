[#responses]
== Test Vector Responses

After the ACVP client downloads and processes a vector set, it *MUST* send the response vectors back to the ACVP server. The following table describes the JSON object that represents a vector set response.

.Vector Set Response Properties
|===
| JSON Property | Description | JSON Type

| acvVersion | The version of the protocol | string
| vsId | The vector set identifier | integer
| testGroups | The test group data | array
|===

The testGroups section is used to organize the ACVP client response in a similar manner to how it receives vectors. Several algorithms *SHALL* require the client to send back group level properties in their response. This structure helps accommodate that.

.Test Group Response Properties
|===
| JSON Property | Description | JSON Type

| tgId | The test group identifier | integer
| tests | The test case data | array
|===

The testCase section is used to organize the ACVP client response in a similar manner to how it receives vectors.  Several algorithms *SHALL* require the client to send back group level properties in their response.  This structure helps accommodate that.

The following table describes the JSON object that represents a test case response for a {spec-algorithm}.

.Test Case Response Properties
|===
| JSON Property | Description | JSON Type

| tcId | The test case identifier | integer
| testPassed | Was the provided `dkm` valid? Only valid for the "VAL" test type. | boolean
| dkm | The derived keying material. Provided by the IUT for "AFT" test type test cases. For single expansion tests. | hex
| dkms | The derived keying materials. Provided by the IUT for "AFT" test type test cases. For multi expansion groups. | array of hex
|===

Here is an abbreviated example of the response

=== Example Test Vectors Response JSON
.Example Response JSON SP800-56Cr1
[source,json]
----
{
  "vsId": 0,
  "algorithm": "KDA",
  "mode": "HKDF",
  "revision": "Sp800-56Cr1",
  "isSample": true,
  "testGroups": [
    {
      "tgId": 1,
      "tests": [
        {
          "tcId": 1,
          "dkm": "C0656E0516EE50E1AD98D0D0113784C8314018A4A00994E31F3F24338234750F8BED8F5CCC3F207411D2253D5FD83E9C0473958B66C3DDE21B024D0A46D14C3392F1CAF82096A569E2A66BF981CB7F7D4493EB1EEF3DBC7370D06647A23FC934DD86D4C3647811380E081566E3AF557466DF1AF07DF2522662FF2D1CE2B8A74DB0A952CB8C8D821DECF81A9840B3A841AB0155D6999C6B206FE184E4A21ED12AB4394871D9966801F9A844F6BAC1CBF30BE46DD8BFBA031DB439F07D023112C8CA3DBB26E3F4BF90741E58C3AED3BEDF091FD6B98502005C96163C2C46207CC23756EA53007064D0CF43AA8A09291F371272B3954E8038BE0E23F69412069A2FAD20205D0806EC1FA37AF077F8A49C1971DCE32D74A0818A891BB5FC86E7964EA814A504A5769AB44EBE463168B53C2AE460835B79654010EBB100A7F969192FFDA0F5BE8CA477BC3383EFEA52165D8DAE337F8E4DDDA261980AA88263DA5E8696B642830FDF1C2A29DF3E79074817EF0351412DA01306637E762631D6CACCCF0CFC85D38C5BE9BD1305B4504D4F5340542F78BBE5644279089A27554CB094CF63442A8866985F5F22395599F0BA4E4FA37D6CEA12C3C38A5AE8F7B22CADB52218C64D0836C2848E295DBFF1BB395AA5D8512AA11D2A5004EC09D5193AEEED1AD09A3D87BAF66BCEF021FB9AE0932D0D9EEA0E1FA10F628143035CEE61C29001"
        },
        {
          "tcId": 2,
          "dkm": "C7F3ED4A40575BF622A24C6495DE509C11330DAE56C423AABF20FF37A6AAF0EEE10009BF7917CF5046D9753A682E1270792382D0486FEBB86C191222A6454A995BB2583D864E946E2D689398EE6FD6C8126186DF71CCB5D46DF45BB2F088AA412C4D635250C11CE13B2B1AAA5FCCF336CB6887A7147FD1235DB3392C0CBE33CB68243756E04AA1E482BEDD6199C5592EEE03F909ACB4A2FBDD5D123507B39C30AFB38F88D1D1560597DC26CD92A1BCCEE24F48DF27994C8A5D668B2575EC4929312285EB14DA2797AD26FB5638F4CBF3935597D64A04CB4312334D517C8BB440157DE7F7FE944025166B9488E87F3FB1BA40B60C88958E12EF8DA1D23BA58FE552C8D6859B10C80746F7AEE24F3CFE29FE55121A35D3B2E073E268C0E66F4825B6456358108E33664BABF67C9748207EAAFAD1FCCF8467DF2DD5AADA48FD6A91782C5E89D6B8395A545B90C5CBC2ADF406941BBD920855054B353743BC1F00905B4512EFBC314490C636DBC9CA9F91784C8D5A2B2855185ADCBAFFDB3FE31AF2084F001658AA2C29D6CD633856D2BC00AF19EA23FFEFA3CAC39AC6D54C61B78C5F8A9ED307FD2503251DAE2C8663544BBF59DD934735FE8038B67220BD3460CCC88B651E59896319271BFE72B78971CD9BA4782DFFB6F60F78FB3B248F9F6DA454A1FADF901FE803B0744120DE1879638CC3458C3112BE739188FBF53B7AD4B4"
        },
        {
          "tcId": 3,
          "dkm": "40E532EB410797A79153B6111F033A4813E9A3F3BCF9EE502477645A86CB6822A06D9F4CAC4386D80897756657855C5921E47FA84B1ED92929C557D25AE91FDF629833C07BC746CA0ED86FC82D7B9E67CF1FCBE98BB9F2087C298FB53B5DBB4FB9CFA38115FABB9D9BDA111EA3806DF31220A3AACC7735D4417F5938CB20FF5EB323883412624A9A4DF076DFBD3D6B7A700546AB72F1663B6F19E2CFD84DDC7F2F249AEEAA0E8A30E70F7F7D860C32C82CDF2755E0F281D926A20FE6C36C037C590FD5B36230FC2949361311BAD514A77BF51FE7E763A30C91666A76085F44F150F7C92C310D42376DE0D09CD4A95A08098164E4A78600AF55783B8BCC0B96ACD6AB2E1B991A070E40B1DDDF3175E9041FB5B04138030EA001E94AE467F8154C445E623AAED1A476A37D23B55D659ABDB79251A6CB1957C9DC15EBAAB0F89AA84371EE0892F3AD2E23EDB128974688CF3B0087CA15A90AFEEEBD3EFBB7AE2E2300D5516A05FB2F3DFF10655FAB35359EA46F49E22C261FDAE1C0213801FAB438B5B02AA39FB58C15162D27F871B41AF7598A43D6EFDB820111D1AFC247A7ED9961DD1745A8ADC774AA627F77B9A7BAB631B323B86269D3D5D4D2C3EDF00148BA878D9356BE146A14F6D49A2294C97447C37E95374A3B02200E863C459336CD38FF4A322D03290CC7A0C17F42E948D99B2CA819654D2260C9AC0D3098A88BEBF4"
        },
        {
          "tcId": 4,
          "dkm": "882A568B7825EA2075CEB551EE607EC75CDCB57ACA51E0A2972883F4F07CFC12F2F15ECD500888D5E52D4A080A7B2A3829799ECC05F2C668AEAA75C578D7D6C21EF8ECC1D7B186BFB535FB42D13C703A6BB116EFF86306348E51DA1EC26E8C9CB9BAB8486E3E8C750796882EB9CF10ED6A121E37C583857780B810B8D916264054C3DA709795ABD9145083F87ED9BF25BF6B77DA59E5038498720755BB9BDAC4CC5F9DA6BC6CBB8EFF7E160BFE7B5C1C159FDCB849B48A6BB367C6D7A4A71518D53F3F02D9F92A2B8C8B19B784F7AB25C553399A13A5E2ECA55A0D003BA96C954BC20AD2AF24B15DD0FEC2D9C5DA35F4385EF0876DF96A0932ED079E5CFACAE62F1765E8F06E85B73637AF6B80F9F3670128F27708D1A0A9FE6C64B7C038044620D201B369F1CA22C699B550493677DCA1874314FD4A9834FF36348D6E596EB305CB41CB973355FE72522B83F352DFE041BDBF20593983850F694D8086F91E5CA899DB85C5D8907158F6F72FE484D21660AC87A76A4DE1D7D134E0CEA074D1EA125C9DF459B651686B8C403FDC297546AF782447EED13210C89AFC67D1A698F83A59A411A44CBE83C2EB0994F126DA066BF043C9EA4239E67E1374B32729DBA51D8D31F2B286B70ECA03159C9D04C679DA1093297DD9D6A77AAF650BA06FA678F2278289DE6EA32A21AFBA67727BC0E3EA93A50853E66841F4181971690809AA"
        },
        {
          "tcId": 5,
          "dkm": "314D4FA329D5EF96DD0C57F8CD329E0839B8C0D75527C36E2B0F6B1841BFEF534F2FBC5FD98ACD474CAA33F65BCDB71B78E4C00A6210F52B0EB5D11267FE6232E5E1F0A8B73C0E2DE14658057404A3AACBF863ABCDEE5D17BA9CAEE96644CDA1A53258FB51967038C79CE232E2389062DAE86BAC395BB2C57DF8A0F98B95BB0B1D700CF18BAC140B33B1820B3AED2E511CEF13A983496E4B9E8D0CC129F3E29582121E0F41E3A9D7EE08680EB16BE2469ED52DB680F84C418D4DB459F3FEFA5A773C12C42D6621AE5BAEAF4134CB891F86E2903482BBA47CFB8D6B8682E85FA0473A395370460AB7321955F565714B382E4C4B7815B679A3D70F38BE41F23689537E4858E54DFEE7AAA87FB09FC0D86017674E6626E713808FC72671D35DF2FCF8693BCDD941EF5A7BE378E9DDAE518F18EC50C41EF3E4F4268DB8B8D2B4DB19E8B21D203B0091086E36392B2C979CED1AABB08A95BE89834D5158947213C4E5D582EC60E02E963E2BD6E21EDC0EFFC9B5CCAE886ED5EE628CFB18567327FFA66647C77C9EC6D19F8B599038D2D3C01A6A2BED4F2FC5A7D7DBA25F668B88810E1766269DA59E55488E12BF2DEB8F8FCC7B56D6FE37F4A7076DF31A35A2292184C9DE9B9E1E99B1CC47F751B619700BFBE638E3B27C97B1DB88F478FB48C16817C911C526F9A4B757DA2AF36DD5B0F5FE585801F30AA6E2CF9CF205566E9D2766"
        }
      ]
    },
{
      "tgId": 17,
      "tests": [
        {
          "tcId": 81,
          "testPassed": true
        },
        {
          "tcId": 82,
          "testPassed": false
        },
        {
          "tcId": 83,
          "testPassed": true
        },
        {
          "tcId": 84,
          "testPassed": true
        },
        {
          "tcId": 85,
          "testPassed": true
        }
      ]
    }
  ]
}    
----

.Example Response JSON SP800-56Cr1
[source,json]
----
{
  "vsId": 0,
  "algorithm": "KDA",
  "mode": "HKDF",
  "revision": "Sp800-56Cr2",
  "isSample": true,
  "testGroups": [
    {
      "tgId": 1,
      "tests": [
        {
          "tcId": 1,
          "dkm": "B23D44EBF223E030508A16CE52ACE3EA9C24155E26748D6EEC9C1886663B91F918DA9B328D39EF656BDEBCB5996F9DF51BC06D146338F5E16CBF4893F104BCAFC704489932912917A4A27A736935B344AE416DD2E033B207595EEBB85486D85902E5297C1156D57FBE3A46867BF4A41FEB066D55F44653C6B19B79EC4053A65C"
        },
        {
          "tcId": 2,
          "dkm": "D966508D28ADFFCB04B7D97D6B2BBF45264BB508AE5B69C990180E26F2C51B2C24D0591C6860A09792A3C8B8C26D9A58B5962A01BC5BD6E072B99643E106CEE104C6CBFBFD7837A6D5C60770882055AA4E8A076C6EF1ACD78B1EBB25143EA0E151C7C0250EE48FE8F9B5304FE47BB168E6A4D1FEE309A4FDE08DF40A2EC2A46A"
        }
      ]
    },
    {
      "tgId": 2,
      "tests": [
        {
          "tcId": 6,
          "dkms": [
            "72E5C6A964F4FAEBA65507465ADEBF9E2CD6E7185382DA09B7757040871D6842067F8A88A874D7C0D5A74864C763B2B3D6BABA1F75586C2F155749EF10F83216C4F3AAF72352C071423C3C459841C0FC397599DBB740B564E2C031A09643E802E881FA9759D87DC1BA1A46C62C5E1FC9AD5AA9F541E0A9BE4943851E679419D0",
            "40A53F75389AD6EFE151CFE466C94D2766443EF7DB5EE93D8A99C41B26C2F37369071A7E1B28C3558CAD2624433E853A521CC74ED53EE8A66C7C829FE6DA0584DB953A8493F33C3DA84E328AE19679C19BAB7EE3ECB75682C7142A3E3B43FABC0C5558E744D102DC193D0BC1EC870ED92F91C68AD8DB5B22D99295DAEF0136F3",
            "869A46E135AC6035EE870BC88758B22D36363F1A399C5B4199394DB77F760B17CAF950EA7414EB764240B62B5DE6E07DD6F4235698A1AC5925064F7B1D088120DFE5BEF99710BF3AE1A6DDCECBA4A57F6C5C6F6C4120A4CA0F7684FD08E7B7DD481D6B1DB34BC14DC6B224E20466C073CC0FEC9882AB4E7A9B0C815EB6A6BC2E"
          ]
        },
        {
          "tcId": 7,
          "dkms": [
            "EB7921CF24F156755E0221CD56BF49FD786307E6AD0E83D896BAE199DA6CB6E057891E50CFC23EE9066345E8568E2E456A549F2A24DD3D712A936145FB664A0EB21809421B0CB43BE8BE9771123CE255868443B56D17F043363C5CB37472CCAEF07FBD55BEB1F5B3A9BA09F51CFC634E114D83C223B7819A23ACFBD464D94D72",
            "53EB7064B2D475CCAA88C0153C5B00775E43D6E7D982D8BB24ED0A79FB8482AAA935B4F0086A10D7731057CFB2DB2F14C229AB7A35FFBC1D9821B483D5E1DA241416B43802650456DE4760204A6174D8982358F28C3EF8869258C99B6F65FDE755A37AFF86F2A3EDEEAC256C0E77C9B9479A1B0B7AA2BB6C611D8739959D7C45",
            "882EA02AE5F9B5CF9061B3173B21881EC9950BEA6CE7F143F490D0FBB1CB7F0212CD573FA74119CFC95597C454E106D77F16A9142EE4D7F7DDE14A03D77AAAABB7945BBD6938C3A7BA9E65E67533AC6185FB3CC6411AE526CA354DA824E3DAC23681EBCE05B9B15DBF8BE6FF458DD108C1CEA2625F505CDB0239B8EB9166E449",
            "964C0650DD3DB9C9C840329233578660230FEAB39DFD0178B027DB34CA0DE5E8D16A44651CA98E9A9A5366F9E41D29CF49B133688613C35A165655E8ECA7AB00DE95F1C86C0DFB0E2A31D7DDB37EED825152374F93E98CF568292875046BA38864CFCE7DD4930A063E0679A67D45680342B16D95CD18606D04DAFED698F4A648"
          ]
        }
      ]
    },
    {
      "tgId": 201,
      "tests": [
        {
          "tcId": 1001,
          "testPassed": true
        },
        {
          "tcId": 1002,
          "testPassed": true
        }    
      ]
    },
    {
      "tgId": 202,
      "tests": [
        {
          "tcId": 1006,
          "testPassed": true
        },
        {
          "tcId": 1007,
          "testPassed": false
        }
      ]
    }
  ]
}
----